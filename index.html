<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alakefak Furniture Movers - Invoice Generator</title>
    <link rel="stylesheet" href="styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <h2>Alakefak Furniture Movers - Invoice System</h2>
            <div class="nav-buttons">
                <button onclick="newInvoice()" class="btn btn-primary">New Invoice</button>
                <button onclick="viewSavedInvoices()" class="btn btn-secondary">View Saved Invoices</button>
            </div>
        </div>
    </nav>

    <!-- Main Invoice Form -->
    <div class="container">
        <div id="invoice-form" class="invoice-container">
            <!-- Invoice Content for PDF -->
            <div id="invoice-content" class="invoice-content">
                <!-- Company Header -->
                <div class="company-header">
                    <div class="header-content">
                        <div class="company-info-arabic">
                            <h1>مؤسسة على كيفك لنقل الأثاث</h1>
                        </div>
                        <div class="logo-container">
                            <div class="logo-circle">
                                <img id="company-logo" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjMEQ0N0ExIiByeD0iMTAwIi8+CjxwYXRoIGQ9Ik0xMDAgNDBMMTMwIDgwSDE3MEwxNDAgMTIwTDE2MCA2MEgxMDBaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTAwIDE2MEw3MCA4MEgzMEw2MCA1MEw0MCA5MEg2MEwxMDAgMTYwWiIgZmlsbD0iI0ZGQkYwMCIvPgo8dGV4dCB4PSIxMDAiIHk9IjE4MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyNCIgZm9udC13ZWlnaHQ9ImJvbGQiPkFMQUtFRkFLPC90ZXh0Pgo8L3N2Zz4=" alt="Alakefak Logo" style="display: block;">
                            </div>
                        </div>
                        <div class="company-info-english">
                            <h1>Ala Kaifak Furniture Movers</h1>
                        </div>
                    </div>
                </div>

                <!-- Invoice Title -->
                <div class="invoice-title">
                    <h2>TAX INVOICE</h2>
                </div>

                <!-- Invoice Details Header -->
                <div class="invoice-header">
                    <div class="bill-to-section">
                        <div class="bill-to-field">
                            <label>Bill To:</label>
                            <textarea id="billTo" class="form-input" placeholder="Customer Name" rows="2" style="resize: vertical; min-height: 50px;"></textarea>
                        </div>
                        <div class="trn-field">
                            <label>TRN:</label>
                            <input type="text" id="trn" class="form-input" placeholder="Tax Registration Number">
                        </div>
                    </div>
                    <div class="invoice-meta">
                        <div class="meta-field">
                            <label>Date:</label>
                            <input type="date" id="invoiceDate" class="form-input">
                        </div>
                        <div class="meta-field">
                            <label>INVOICE NO.</label>
                            <input type="text" id="invoiceNumber" class="form-input" style="font-weight: bold;">
                        </div>
                        <div class="meta-field">
                            <label>Address:</label>
                            <input type="text" id="address" class="form-input" value="Abu Dhabi">
                        </div>
                        <div class="meta-field">
                            <label>BOX:</label>
                            <input type="text" id="box" class="form-input" value="130483">
                        </div>
                        <div class="meta-field">
                            <label>TRN#:</label>
                            <input type="text" id="companyTrn" class="form-input" value="100234725800003">
                        </div>
                    </div>
                </div>

                <!-- Items Table -->
                <div class="items-section">
                    <table class="items-table" id="itemsTable">
                        <thead>
                            <tr>
                                <th>Item</th>
                                <th>Description</th>
                                <th>Quantity</th>
                                <th>Unit Rate</th>
                                <th>Amount</th>
                                <th>5% VAT</th>
                                <th>Total Amount</th>
                                <th class="no-print">Action</th>
                            </tr>
                        </thead>
                        <tbody id="itemsBody">
                            <tr class="item-row">
                                <td>1</td>
                                <td>
                                    <textarea class="description-input" placeholder="Service description..." rows="3"></textarea>
                                </td>
                                <td>
                                    <input type="number" class="quantity-input" value="1" min="1">
                                </td>
                                <td>
                                    <input type="number" class="rate-input" placeholder="0.00" step="0.01" min="0" max="100000">
                                    <span class="currency">AED</span>
                                </td>
                                <td class="amount-cell">
                                    <span class="amount-value">0</span>
                                    <span class="currency">AED</span>
                                </td>
                                <td class="vat-cell">
                                    <span class="vat-value">0</span>
                                    <span class="currency">AED</span>
                                </td>
                                <td class="total-cell">
                                    <span class="total-value">0</span>
                                    <span class="currency">AED</span>
                                </td>
                                <td class="no-print"><button onclick="removeItem(this)" class="btn btn-danger btn-sm">Remove</button></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="table-controls no-print">
                        <button onclick="addItem()" class="btn btn-secondary">Add Item</button>
                    </div>
                    
                    <!-- Totals Section -->
                    <div class="totals-section">
                        <div class="totals-row">
                            <span class="total-label">Total</span>
                            <div class="totals-amounts">
                                <span id="subtotal">0.00 AED</span>
                                <span id="totalVat">0.00 AED</span>
                                <span id="grandTotal">0.00 AED</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Amount in Words -->
                    <div class="amount-words">
                        <span id="amountInWords">Zero AED only</span>
                    </div>
                </div>

                <!-- Company Footer -->
                <div class="company-footer">
                    <div class="footer-section">
                        <div class="stamp-area">
                            <div class="stamp-container">
                                <img id="company-stamp" src="" alt="Company Stamp" style="display: none;">
                            </div>
                            <div class="signature-line">
                                <img id="company-signature" src="" alt="Signature" style="display: none;">
                            </div>
                        </div>
                        
                        <div class="bank-details">
                            <div class="bank-info-box">
                                <div><strong>ALA KAIFAK FURNITURE MOVERS</strong></div>
                                <div><strong>BANK: FIRST ABU DHABI BANK</strong></div>
                                <div><strong>IBAN: AE530351411323477485017</strong></div>
                                <div><strong>A/C NO: 1411323477485017</strong></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="contact-info">
                        <div class="contact-row-top">
                            Tel.: +971 2 5529191, Fax: +971 2 5529195, Mob.: +971 50 8199942
                        </div>
                        <div class="contact-row-bottom">
                            E-mail: alakefakcomp@gmail.com, P.O.Box: 130483, Abu Dhabi - U.A.E.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Control Panel -->
        <div class="control-panel no-print">
            <div class="panel-section">
                <h3>Invoice Actions</h3>
                <button onclick="generatePDF()" class="btn btn-success">Generate & Download PDF</button>
                <button onclick="saveInvoice()" class="btn btn-primary">Save Invoice</button>
                <button onclick="printInvoice()" class="btn btn-secondary">Print Invoice</button>
            </div>
            
            <div class="panel-section">
                <h3>📧 Email Invoice</h3>
                <div class="email-form">
                    <div class="email-group">
                        <label for="emailTo">Send To:</label>
                        <input type="email" id="emailTo" class="form-input" placeholder="customer@example.com" style="margin-bottom: 8px;">
                    </div>
                    <div class="email-group">
                        <label for="emailSubject">Subject:</label>
                        <input type="text" id="emailSubject" class="form-input" placeholder="Invoice #1234 - Alakefak Furniture Movers" style="margin-bottom: 8px;">
                    </div>
                    <div class="email-group">
                        <label for="emailMessage">Message:</label>
                        <textarea id="emailMessage" class="form-input" rows="3" placeholder="Dear Customer,&#10;&#10;Please find attached your invoice.&#10;&#10;Best regards,&#10;Alakefak Furniture Movers" style="margin-bottom: 10px; resize: vertical;"></textarea>
                    </div>
                    <button onclick="sendInvoiceByEmail()" class="btn btn-primary" style="width: 100%;">📨 Send Invoice by Email</button>
                    <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">✅ Free email service - works directly from browser</small>
                </div>
            </div>
            
            <div class="panel-section">
                <h3>Template Selection</h3>
                <select id="templateSelect" onchange="changeTemplate()" class="form-input" style="margin-bottom: 10px;">
                    <option value="modern">Modern Professional (Default)</option>
                    <option value="classic">Classic Traditional</option>
                    <option value="minimal">Minimal Clean</option>
                    <option value="elegant">Elegant Formal</option>
                    <option value="corporate">Corporate Blue</option>
                    <option value="luxury">Luxury Gold</option>
                    <option value="tech">Tech Modern</option>
                    <option value="vintage">Vintage Style</option>
                    <option value="colorful">Colorful Creative</option>
                </select>
            </div>
            
            <div class="panel-section">
                <h3>Upload Company Assets (Optional)</h3>
                <div class="upload-group">
                    <label for="logoUpload">Company Logo:</label>
                    <input type="file" id="logoUpload" accept="image/*" onchange="handleLogoUpload(event)">
                    <div class="size-control">
                        <label for="logoSize">Logo Size:</label>
                        <input type="range" id="logoSize" min="120" max="400" value="180" onchange="adjustLogoSize(this.value)">
                        <span id="logoSizeValue">180px</span>
                    </div>
                </div>
                <div class="upload-group">
                    <label for="stampUpload">Company Stamp:</label>
                    <input type="file" id="stampUpload" accept="image/*" onchange="handleStampUpload(event)">
                    <div class="size-control">
                        <label for="stampSize">Stamp Size:</label>
                        <input type="range" id="stampSize" min="100" max="400" value="200" onchange="adjustStampSize(this.value)">
                        <span id="stampSizeValue">200px</span>
                    </div>
                </div>
                <div class="upload-group">
                    <label for="signatureUpload">Signature:</label>
                    <input type="file" id="signatureUpload" accept="image/*" onchange="handleSignatureUpload(event)">
                </div>
            </div>
        </div>

        <!-- Saved Invoices Modal -->
        <div id="savedInvoicesModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeSavedInvoicesModal()">&times;</span>
                <h2>Saved Invoices</h2>
                <div id="savedInvoicesList"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
